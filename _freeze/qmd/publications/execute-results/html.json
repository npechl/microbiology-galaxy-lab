{
  "hash": "e90de5b9f2ec3cad0ac35fb1cf3eb154",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Publications\"\nexecute:\n    eval: true\n    warning: false\nformat:\n  html:\n    fig-width: 9\n    fig-height: 10\n---\n\n\n\n\n\n## Load `libraries`\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# install.packages(\"data.table\")\nlibrary(data.table)\n# install.packages(\"stringr\")\nlibrary(stringr)\n\nlibrary(tidytext)\n\n# install.packages(c(\"ggplot2\", \"ggrepel\", \"ggtext\", \"ggh4x\"))\nlibrary(ggplot2)\nlibrary(ggrepel)\nlibrary(ggtext)\nlibrary(ggh4x)\n\nlibrary(shadowtext)\n\n# install.packages(\"extrafont\")\nlibrary(extrafont)\nlibrary(packcircles)\n\nlibrary(colorspace)\n\nlibrary(patchwork)\n```\n:::\n\n\n\n\n\n## Input data\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nyears            <- fread(\"https://raw.githubusercontent.com/usegalaxy-eu/microgalaxy_paper_2025/refs/heads/main/results/citations/years.csv\")\nmethods          <- fread(\"https://raw.githubusercontent.com/usegalaxy-eu/microgalaxy_paper_2025/refs/heads/main/results/citations/methods.csv\")\ntarget_technical <- fread(\"https://raw.githubusercontent.com/usegalaxy-eu/microgalaxy_paper_2025/refs/heads/main/results/citations/technical_target.csv\")\ntarget_organisms <- fread(\"https://raw.githubusercontent.com/usegalaxy-eu/microgalaxy_paper_2025/refs/heads/main/results/citations/targeted_organisms.csv\")\n\nyears$year <- seq(2005, 2026)\nyears <- years |> melt(id.vars = \"year\", value.factor = FALSE, variable.factor = FALSE)\nyears$variable <- years$variable |> str_to_title()\n\n\nmethods$cluster          <- \"Methods\"\ntarget_organisms$cluster <- \"Targetted organisms\"\ntarget_technical$cluster <- \"Technical target\"\n\np0 <- rbind(methods, target_organisms, target_technical)\n\ncolnames(p0) <- c(\"variable\", \"counts\", \"perc\", \"cluster\")\n\np0$perc <- p0$perc / 100\n```\n:::\n\n\n\n\n\n\n## Barplots \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngr1 <- years |>\n    ggplot(aes(year, value)) +\n    \n    geom_point(aes(fill = variable), color = \"grey25\", \n               shape = 21, size = 5.3, stroke = .25, \n               position = position_dodge(width = .9)) +\n    \n    geom_col(aes(fill = variable), color = \"grey25\", \n             linewidth = .15, \n             position = position_dodge(width = .9)) +\n    \n    geom_point(aes(color = variable),\n               size = 4.65,\n               position = position_dodge(width = .9)) +\n    \n    scale_x_continuous(expand = c(0, 0)) +\n    scale_y_continuous(expand = c(0, 0), limits = c(0, 1200), breaks = seq(200, 1000, by = 200)) +\n    \n    scale_fill_manual(values = c(\"All\" = \"#4E79A7\" |> lighten(.25), \"Microbial\" = \"#E15759\" |> darken(.3))) +\n    scale_color_manual(values = c(\"All\" = \"#4E79A7\" |> lighten(.25), \"Microbial\" = \"#E15759\" |> darken(.3))) +\n    \n    theme_minimal(base_family = \"Calibri\") +\n    \n    theme(\n        legend.position = c(.15, .75),\n        legend.title = element_blank(),\n        \n        axis.line = element_line(lineend = \"round\"),\n        axis.ticks = element_line(lineend = \"round\"),\n        \n        panel.grid.major.x = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        \n        panel.grid.minor.y = element_line(linetype = \"dotted\", lineend = \"round\"),\n        \n        axis.title.x = element_text(margin = margin(t = 10)),\n        axis.title.y = element_markdown(margin = margin(r = 10))\n    ) +\n    \n    labs(x = \"Year\", y = \"**Number of publications**<br>citing Galaxy papers\")\n\n\ngr2 <- p0 |>\n    ggplot(aes(reorder_within(variable, -perc, cluster), perc)) +\n    \n    geom_point(fill = \"#4E79A7\" |> lighten(.25), color = \"grey25\", \n               shape = 21, size = 6.3, stroke = .25) +\n    \n    geom_col(width = .75, fill = \"#4E79A7\" |> lighten(.25), color = \"grey25\", linewidth = .15) +\n    \n    geom_point(color = \"#4E79A7\" |> lighten(.25), size = 5.63) +\n    \n    scale_y_continuous(expand = c(0, 0), limits = c(0, 0.13), labels = scales::percent, breaks = seq(.01, .12, by = .02)) +\n    scale_x_reordered() +\n    \n    facet_grid2(cols = vars(cluster), space = \"free_x\", scales = \"free_x\", axes = \"all\") +\n    \n    theme_minimal(base_family = \"Calibri\") +\n    \n    theme(\n        axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1),\n        \n        panel.grid.major.x = element_blank(),\n        panel.grid.minor.x = element_blank(),\n        \n        panel.grid.minor.y = element_line(linetype = \"dotted\", lineend = \"round\"),\n        \n        axis.line = element_line(lineend = \"round\"),\n        axis.ticks = element_line(lineend = \"round\"),\n        \n        strip.text = element_text(face = \"bold\"),\n        \n        axis.title.x = element_blank(), # element_text(margin = margin(t = 10)),\n        axis.title.y = element_markdown(margin = margin(r = 10))\n    ) +\n    \n    labs(x = \"Target\", y = \"**Percentage in the microbial related papers**<br>citing Galaxy papers\")\n\n\nmulti <- (gr1 / gr2) + \n    plot_annotation(tag_levels = \"A\") &\n    theme(\n        plot.tag = element_text(size = 18, face = \"bold\", family = \"Calibri\"),\n        plot.background = element_rect(fill = \"transparent\", color = NA)\n    )\n\nmulti\n```\n\n::: {.cell-output-display}\n![](publications_files/figure-html/unnamed-chunk-3-1.svg)\n:::\n:::",
    "supporting": [
      "publications_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}